<?PHP/** * Simpla CMS * * @copyright 	2011 Denis Pikusov * @link 		http://simplacms.ru * @author 		Denis Pikusov * * Этот класс использует шаблон page.tpl * */require_once('View.php');use Communitys\Validation\Fgsa as FgsaValidation;use Phalcon\Http\Request;class InventoryView extends View{    function fetch()    {        $url = $this->request->get('page_url', 'string');        $page = $this->pages->get_page($url);        // Getting a request instance        $request = new Request();        if ($request->isPost()) {            // Check whether the request was made with Ajax            $validation = new FgsaValidation();            $messages = $validation->validate($_POST);            if (count($messages)) {                $errors = new stdClass();                foreach ($messages as $key =>$message) {                    $errors->text[$message->getField()][]= $message->getMessage();                    //echo $message, '<br>';                }                $this->debug->console_log($errors);            }        }        print_r($this->request->check_session());        // Отображать скрытые страницы только админу        if(empty($page) || (!$page->visible && empty($_SESSION['admin'])))            return false;        if($this->request->check_session() && $this->request->post('fgsa'))        {        }        $this->design->assign('page', $page);        $this->design->assign('meta_title', $page->meta_title);        $this->design->assign('meta_keywords', $page->meta_keywords);        $this->design->assign('meta_description', $page->meta_description);        $this->design->assign('wrapper', 'home_login.tpl');        return $this->design->fetch('inventory/forms/'.$url.'_form.tpl');    }}