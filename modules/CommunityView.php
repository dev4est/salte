<?php/** * Created by PhpStorm. * User: user * Date: 15.04.18 * Time: 13:14 *//** * Simpla CMS * * @copyright 	2011 Denis Pikusov * @link 		http://simplacms.ru * @author 		Denis Pikusov * * Этот класс использует шаблон page.tpl * */require_once('View.php');/** * @property mixed|null communitys */class CommunityView extends View{    function fetch()    {        $id = $this->request->get('id', 'integer');        $community = $this->communitys->get_community((int) $id);        //console_log($community);        $topic = $this->communitys->Topic();        // Отображать скрытые страницы только админу        if(empty($community) || (!$community->visible && empty($_SESSION['admin'])))            return false;        $this->design->assign('topics',  $topic->getTopics(['community_id'=>$id]));        $this->design->assign('nav_bar', 5);        $this->design->assign('community', $community);        $this->design->assign('meta_title', $community->meta_title);        $this->design->assign('meta_keywords', $community->meta_keywords);        $this->design->assign('meta_description', $community->meta_description);        return $this->design->fetch('community.tpl');    }    public function messagesAction()    {        $id = $this->request->get('id', 'integer');        $community = $this->communitys->get_community((int) $id);        // Отображать скрытые страницы только админу        if(empty($community) || (!$community->visible && empty($_SESSION['admin'])))            return false;        $this->design->assign('community', $community);        $this->design->assign('nav_bar', 4);        return $this->design->fetch('community.tpl');    }    public function usersAction()    {        $id = $this->request->get('id', 'integer');        $community = $this->communitys->get_community((int) $id);        $users = $this->communitys->Users();        $this->design->assign('users', $users->getUsers(['community_id'=>$id]));        // Отображать скрытые страницы только админу        if(empty($community) || (!$community->visible && empty($_SESSION['admin'])))            return false;        $this->design->assign('community', $community);        $this->design->assign('nav_bar', 3);        return $this->design->fetch('community.tpl');    }}