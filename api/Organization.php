<?php/** * Created by PhpStorm. * User: user * Date: 15.06.18 * Time: 11:15 */use Zend\Crypt\Password\Bcrypt;class Organization extends Simpla{    public function add_organization( array $param)    {        if(isset($param['password']))            $param['password_hash'] = $this->create_password($param['password']);        unset($param['password']);        $query = $this->db->placehold("SELECT count(*) as count FROM __users WHERE email=?", $param['email']);        $this->db->query($query);        if($this->db->result('count') > 0)            return false;        $query = $this->db->placehold("INSERT INTO __users SET ?%", $param);        $this->db->query($query);        return $this->db->insert_id();    }    /**     * @param string $password     * @return string     */    public function create_password(string $password)    {        $bcrypt = new Bcrypt(['cost' => 13]);        return $bcrypt->create($password);    }    /**     * @param string $email     * @return bool|string     */    public function exist_organization(string $email='')    {        $this->db->query('SELECT count(*) as count FROM __users WHERE email=?', $email);        $exist = $this->db->result('count');        if($exist >0)            return true;        return false;    }    public function validate_form($param)    {        $errors = new stdClass();        if(empty($param->username))            $errors->empty_username  ='empty_username';        if(empty($param->email))            $errors->empty_email ='empty_email';        else if($this->exist_organization($param->email))            $errors->organization_exists = 'organization_exists';        if(empty($param->password))            $errors->empty_password ='empty_password';        if(count((array)$errors) > 0)            return $errors;        else            return false;    }    /**     * @return bool|mixed     */    public function get_legal_form()    {        $this->db->query('SELECT name, id FROM __legal_form ORDER BY id');        $results = $this->db->results();        if(count($results) >0)            return $results;        return false;    }}